let StartDateTime = datetime(2019-01-07);
let EndDateTime = datetime(2019-02-12);
vwTopicMetadata_ContentDashboard
| join kind= inner(
   PageView
    | where Url contains "https://docs.microsoft.com/en-us/azure/machine-learning"
    | where StartDateTime between (StartDateTime .. EndDateTime)
) on TopicKey
| join kind = leftouter (
   RatingVerbatim 
   | where RatingDateTime between (StartDateTime .. EndDateTime)
) on TopicKey
| summarize
    Visits = dcount(enrich_session_id),
    UniqueVisitors = dcount(VisitorId),
    BounceRate = countif(IsBounce == true) * 100 / count(),
    MedianActivePvl = percentile(ActivePageViewLength, 50), 
    OrganicSearch = dcountif( PageViewId,ReferrerType == 'Organic Search') * 100 / dcount(PageViewId),
    Views = count(),
    CSAT = sum(Rating) * 100 / count(InstanceId),
    CSATCount = count(InstanceId)
    by Url, TopicKey 
| sort by Visits asc